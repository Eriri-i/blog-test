(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{274:function(t,a,s){"use strict";s.r(a);var n=s(13),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"docker部署gitlab-jenkins-sonarqube实现代码质量扫描"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker部署gitlab-jenkins-sonarqube实现代码质量扫描"}},[t._v("#")]),t._v(" docker部署Gitlab+Jenkins+Sonarqube实现代码质量扫描")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#1-sonarqube%E5%AE%89%E8%A3%85"}},[t._v("1. sonarqube安装")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#11-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"}},[t._v("1.1. 创建目录结构")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#12-%E7%BC%96%E5%86%99dokcer-composeyml"}},[t._v("1.2. 编写dokcer-compose.yml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#13-%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%B9%B6%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"}},[t._v("1.3. 构建镜像并启动容器")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#14-sonarqube%E6%B1%89%E5%8C%96"}},[t._v("1.4. sonarqube汉化")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#2-gitlab%E5%AE%89%E8%A3%85"}},[t._v("2. gitlab安装")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#21-%E6%90%9C%E7%B4%A2%E9%95%9C%E5%83%8F"}},[t._v("2.1. 搜索镜像")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#22-%E5%87%86%E5%A4%87%E6%8C%82%E8%BD%BD%E7%9B%AE%E5%BD%95"}},[t._v("2.2. 准备挂载目录")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#23-%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8"}},[t._v("2.3. 创建容器")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#24-%E6%9B%B4%E6%94%B9external_url"}},[t._v("2.4. 更改external_url")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#25-gitlab%E6%B1%89%E5%8C%96"}},[t._v("2.5. gitlab汉化")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#3-jenkins%E5%AE%89%E8%A3%85"}},[t._v("3. jenkins安装")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#31-%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85jkdmavengit"}},[t._v("3.1. 本地安装jkd、maven、git")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#32-%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8"}},[t._v("3.2. 创建容器")])])])])]),t._v(" "),s("h2",{attrs:{id:"_1-sonarqube安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-sonarqube安装"}},[t._v("#")]),t._v(" 1. sonarqube安装")]),t._v(" "),s("ul",[s("li",[t._v("Sonarqube使用需要用到数据库，由于最新版的sonarqube不支持mysql，故选用sonarqube 6.7.4，数据库选用mysql 5.7.16")]),t._v(" "),s("li",[t._v("sonarqube6.7 Requirements 说明地址："),s("a",{attrs:{href:"https://docs.sonarqube.org/display/SONARQUBE67/Requirements",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.sonarqube.org/display/SONARQUBE67/Requirements"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"_1-1-创建目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-创建目录结构"}},[t._v("#")]),t._v(" 1.1. 创建目录结构")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /home/mysonar")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /home/mysonar/mysql /home/mysonar/sonar")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /home/mysonar")]),t._v("\n")])])]),s("h3",{attrs:{id:"_1-2-编写dokcer-compose-yml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-编写dokcer-compose-yml"}},[t._v("#")]),t._v(" 1.2. 编写dokcer-compose.yml")]),t._v(" "),s("ul",[s("li",[t._v("创建mysql的配置文件：my.conf，放入/home/mysql")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vi /home/mysql/my.conf")]),t._v("\n")])])]),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysqld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nuser=mysql\ndefault"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("storage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("engine=INNODB\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#character-set-server=utf8")]),t._v("\ncharacter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("handshake=FALSE\ncharacter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4\ncollation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server=utf8mb4_unicode_ci\ninit_connect='SET NAMES utf8mb4'\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#utf8mb4字符集可以存储emoji表情字符")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#default-character-set=utf8")]),t._v("\ndefault"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set=utf8mb4\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#default-character-set=utf8")]),t._v("\ndefault"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("character"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("set=utf8mb4\n")])])]),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim docker-compose.yml")]),t._v("\n")])])]),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mysql")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3306:3306"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./mysql/data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/lib/mysql\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./mysql/conf.d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/mysql/conf.d\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" MYSQL_ROOT_PASSWORD=root\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" MYSQL_DATABASE=sonarqube\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"always"')]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sonarqube")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sonarqube"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("6.7.4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9000:9000"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./sonar/data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/opt/sonarqube/data\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./sonar/log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/opt/sonarqube/log\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./sonar/extensions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/opt/sonarqube/extensions\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./sonar/conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/opt/sonarqube/conf\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./sonar/extensions/plugins/sonar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("l10n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("plugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("1.19.jar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/opt/sonarqube/extensions/plugins/sonar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("l10n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("plugin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("1.19.jar\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SONARQUBE_JDBC_USERNAME=root\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SONARQUBE_JDBC_PASSWORD=root\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" SONARQUBE_JDBC_URL=jdbc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("3306/sonarqube"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("useUnicode=true"),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPer")]),t._v("\nformance\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("links")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("mysql\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mysql\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"always"')]),t._v("\n")])])]),s("h3",{attrs:{id:"_1-3-构建镜像并启动容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-构建镜像并启动容器"}},[t._v("#")]),t._v(" 1.3. 构建镜像并启动容器")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("sudo docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f ./docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose.yml up "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("d\n")])])]),s("h3",{attrs:{id:"_1-4-sonarqube汉化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-sonarqube汉化"}},[t._v("#")]),t._v(" 1.4. sonarqube汉化")]),t._v(" "),s("p",[t._v("查看对应版本的汉化包："),s("a",{attrs:{href:"https://github.com/xuhuisheng/sonar-l10n-zh",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/xuhuisheng/sonar-l10n-zh"),s("OutboundLink")],1),t._v(" "),s("img",{attrs:{src:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2020.cnblogs.com%2Fblog%2F1678765%2F202101%2F1678765-20210111160136202-641019203.png&refer=http%3A%2F%2Fimg2020.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1614948592&t=e793ac16d552823e5b939148c27e7e7e",alt:"alt"}})]),t._v(" "),s("p",[t._v("汉化包下载地址："),s("a",{attrs:{href:"https://github.com/xuhuisheng/sonar-l10n-zh/tags?after=sonar-l10n-zh-plugin-1.27",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/xuhuisheng/sonar-l10n-zh/tags?after=sonar-l10n-zh-plugin-1.27"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("将下载好的汉化包放入：/home/mysonar/sonar/extensions/plugins/")]),t._v(" "),s("li",[t._v("切换到：/home/mysonar")]),t._v(" "),s("li",[t._v("删除原来构建好的镜像")]),t._v(" "),s("li",[t._v("重新构建镜像并启动容器")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("sudo docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f ./docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose.yml up "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("build\n")])])]),s("h2",{attrs:{id:"_2-gitlab安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-gitlab安装"}},[t._v("#")]),t._v(" 2. gitlab安装")]),t._v(" "),s("h3",{attrs:{id:"_2-1-搜索镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-搜索镜像"}},[t._v("#")]),t._v(" 2.1. 搜索镜像")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mysonar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker search gitlab")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-2-准备挂载目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-准备挂载目录"}},[t._v("#")]),t._v(" 2.2. 准备挂载目录")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /home/mygitlab")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZbp12a57ehfe3z2g7t0u7Z mygitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mkdir /home/mygitlab/etc/ /home/mygitlab/log/ /home/mygitlab/opt/")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-3-创建容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-创建容器"}},[t._v("#")]),t._v(" 2.3. 创建容器")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("docker run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p 8888"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("80 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p 2222"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("22 \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name mygitlab \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("restart always \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("privileged=true \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /home/mygitlab/etc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/gitlab \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /home/mygitlab/log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/log/gitlab \\\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /home/mygitlab/opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/opt/gitlab \\\n gitlab/gitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ce\n")])])]),s("h3",{attrs:{id:"_2-4-更改external-url"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-更改external-url"}},[t._v("#")]),t._v(" 2.4. 更改external_url")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("vim /home/mygitlab/etc/gitlab.rb          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#编辑配置文件  ")]),t._v("\nexternal_url 'http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//192.168.1.21'        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#改为自己的ip地址")]),t._v("\ndocker restart mygitlab                   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重启容器")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-5-gitlab汉化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-gitlab汉化"}},[t._v("#")]),t._v(" 2.5. gitlab汉化")]),t._v(" "),s("ul",[s("li",[t._v("查看gitlab版本")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("cat /home/mygitlab/opt/gitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rails/VERSION\n")])])]),s("ul",[s("li",[s("p",[t._v("下载对应版本到服务器中："),s("a",{attrs:{href:"https://gitlab.com/xhang/gitlab/-/tags",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitlab.com/xhang/gitlab/-/tags"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("解压并拷贝文件到目录")])])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("cp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rf gitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v12.4.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("zh/* \\\n/home/mygitlab/opt/gitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rails/opt/gitlab/embedded/service/gitlab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("rails/\ndocker restart mygitlab              "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重启容器")]),t._v("\n")])])]),s("h2",{attrs:{id:"_3-jenkins安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-jenkins安装"}},[t._v("#")]),t._v(" 3. jenkins安装")]),t._v(" "),s("h3",{attrs:{id:"_3-1-本地安装jkd、maven、git"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-本地安装jkd、maven、git"}},[t._v("#")]),t._v(" 3.1. 本地安装jkd、maven、git")]),t._v(" "),s("p",[t._v("也可以在jenkins容器生成后，进入容器中安装")]),t._v(" "),s("h3",{attrs:{id:"_3-2-创建容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-创建容器"}},[t._v("#")]),t._v(" 3.2. 创建容器")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("docker run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("d "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("restart=always "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p 9001"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8080 \\\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /var/jenkins_home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/jenkins_home \\\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /var/run/docker.sock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/run/docker.sock \\\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /usr/bin/git"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/usr/bin/git \\\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /usr/local/java/jdk1.8.0_271"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/usr/local/java/jdk1.8.0_271 \\\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v /usr/local/maven/apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("maven"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("3.6.3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/usr/local/maven/apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("maven"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("3.6.3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name jenkins jenkins/jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);